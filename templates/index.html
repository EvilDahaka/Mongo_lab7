<!DOCTYPE html>
<html lang="uk">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Blog System</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet">
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
            rel="stylesheet">
        <style>
        .post-card { transition: transform 0.2s; }
        .post-card:hover { transform: translateY(-5px); }
        .badge-tag { margin: 2px; }
        .comment-item { border-left: 3px solid #007bff; padding-left: 15px; margin-bottom: 15px; }
        .navbar-brand { font-weight: bold; }
        .admin-section { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
    </style>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="#" onclick="showHome()"><i
                        class="bi bi-journal-text"></i> Blog System</a>
                <button class="navbar-toggler" type="button"
                    data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item"><a class="nav-link" href="#"
                                onclick="showHome()">Головна</a></li>
                        <li class="nav-item"><a class="nav-link" href="#"
                                onclick="showCategories()">Категорії</a></li>
                        <li class="nav-item"><a class="nav-link" href="#"
                                onclick="showStats()">Статистика</a></li>
                    </ul>
                    <div id="authButtons" class="d-flex">
                        <button class="btn btn-outline-light me-2"
                            onclick="showLogin()">Вхід</button>
                        <button class="btn btn-light"
                            onclick="showRegister()">Реєстрація</button>
                    </div>
                    <div id="userMenu" class="d-none">
                        <span class="text-light me-3">Вітаємо, <span
                                id="username"></span></span>
                        <button class="btn btn-outline-light me-2"
                            onclick="showAdminPanel()">Адмін панель</button>
                        <button class="btn btn-outline-light"
                            onclick="logout()">Вихід</button>
                    </div>
                </div>
            </div>
        </nav>

        <div class="container mt-4">
            <div id="content"></div>
        </div>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script>
        // Змініть це на адресу вашого API, якщо він на іншому порту/домені
        const API_BASE = 'http://localhost:8000';
        let state = {
            token: localStorage.getItem('token'),
            user: null,
            currentPage: 1
        };

        async function apiCall(endpoint, options = {}) {
            const headers = { 'Content-Type': 'application/json', ...options.headers };
            if (state.token) headers['Authorization'] = `Bearer ${state.token}`;
            
            try {
                const response = await fetch(`${API_BASE}${endpoint}`, { ...options, headers });
                if (!response.ok && response.status === 401) {
                    logout();
                    throw new Error('Unauthorized');
                }
                return response.status === 204 ? null : await response.json();
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        async function init() {
            if (state.token) {
                try {
                    state.user = await apiCall('/users/me');
                    document.getElementById('authButtons').classList.add('d-none');
                    document.getElementById('userMenu').classList.remove('d-none');
                    document.getElementById('username').textContent = state.user.username;
                } catch {
                    logout();
                }
            }
            showHome();
        }

        function logout() {
            state.token = null;
            state.user = null;
            localStorage.removeItem('token');
            document.getElementById('authButtons').classList.remove('d-none');
            document.getElementById('userMenu').classList.add('d-none');
            showHome();
        }

        function showLogin() {
            document.getElementById('content').innerHTML = `
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h3 class="card-title">Вхід</h3>
                                <form onsubmit="handleLogin(event)">
                                    <div class="mb-3">
                                        <label class="form-label">Email</label>
                                        <input type="email" class="form-control" id="loginEmail" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Пароль</label>
                                        <input type="password" class="form-control" id="loginPassword" required>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Увійти</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function showRegister() {
            document.getElementById('content').innerHTML = `
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h3 class="card-title">Реєстрація</h3>
                                <form onsubmit="handleRegister(event)">
                                    <div class="mb-3">
                                        <label class="form-label">Ім'я користувача</label>
                                        <input type="text" class="form-control" id="regUsername" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Email</label>
                                        <input type="email" class="form-control" id="regEmail" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Пароль</label>
                                        <input type="password" class="form-control" id="regPassword" required>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Зареєструватись</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        async function handleLogin(e) {
            e.preventDefault();
            const formData = new URLSearchParams();
            formData.append('username', document.getElementById('loginEmail').value);
            formData.append('password', document.getElementById('loginPassword').value);

            try {
                const data = await fetch(`${API_BASE}/auth/jwt/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: formData
                }).then(r => r.json());

                state.token = data.access_token;
                localStorage.setItem('token', state.token);
                await init();
                alert('Успішний вхід!');
            } catch {
                alert('Помилка входу');
            }
        }

        async function handleRegister(e) {
            e.preventDefault();
            try {
                await apiCall('/auth/register', {
                    method: 'POST',
                    body: JSON.stringify({
                        username: document.getElementById('regUsername').value,
                        email: document.getElementById('regEmail').value,
                        password: document.getElementById('regPassword').value
                    })
                });
                alert('Реєстрація успішна! Тепер увійдіть.');
                showLogin();
            } catch {
                alert('Помилка реєстрації');
            }
        }

        async function showHome() {
            const posts = await apiCall('/api/posts?page=1&size=10');
            const categories = await apiCall('/api/categories');
            
            let html = `
                <div class="row mb-4">
                    <div class="col-md-8">
                        <div class="input-group mb-3">
                            <input type="text" class="form-control" id="searchQuery" placeholder="Пошук постів...">
                            <button class="btn btn-primary" onclick="searchPosts()"><i class="bi bi-search"></i> Шукати</button>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <select class="form-select" onchange="filterByCategory(this.value)">
                            <option value="">Всі категорії</option>
                            ${categories.map(c => `<option value="${c.id}">${c.name}</option>`).join('')}
                        </select>
                    </div>
                </div>
                <div class="row">
            `;

            posts.items.forEach(post => {
                html += `
                    <div class="col-md-6 mb-4">
                        <div class="card post-card h-100">
                            <div class="card-body">
                                <h5 class="card-title">${post.title}</h5>
                                <p class="card-text">${post.content.substring(0, 150)}...</p>
                                <div class="mb-2">
                                    ${post.tags.map(t => `<span class="badge bg-secondary badge-tag">${t}</span>`).join('')}
                                </div>
                                <p class="text-muted small">
                                    <i class="bi bi-person"></i> ${post.author_name} | 
                                    <i class="bi bi-calendar"></i> ${new Date(post.created_at).toLocaleDateString('uk-UA')}
                                    ${post.category_name ? ` | <i class="bi bi-folder"></i> ${post.category_name}` : ''}
                                </p>
                                <button class="btn btn-primary btn-sm" onclick="showPost('${post.id}')">Читати</button>
                            </div>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            document.getElementById('content').innerHTML = html;
        }

        async function showPost(id) {
            const post = await apiCall(`/api/posts/${id}`);
            const comments = await apiCall(`/api/posts/${id}/comments`);

            let html = `
                <div class="card mb-4">
                    <div class="card-body">
                        <h2>${post.title}</h2>
                        <p class="text-muted">
                            <i class="bi bi-person"></i> ${post.author_name} | 
                            <i class="bi bi-calendar"></i> ${new Date(post.created_at).toLocaleDateString('uk-UA')}
                            ${post.category_name ? ` | <i class="bi bi-folder"></i> ${post.category_name}` : ''}
                        </p>
                        <div class="mb-3">
                            ${post.tags.map(t => `<span class="badge bg-secondary badge-tag">${t}</span>`).join('')}
                        </div>
                        <hr>
                        <div>${post.content}</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-body">
                        <h4>Коментарі (${comments.length})</h4>
                        ${comments.map(c => `
                            <div class="comment-item">
                                <strong>${c.author}</strong>
                                <small class="text-muted">${new Date(c.created_at).toLocaleDateString('uk-UA')}</small>
                                <p>${c.content}</p>
                            </div>
                        `).join('')}
                        
                        <hr>
                        <h5>Додати коментар</h5>
                        <form onsubmit="addComment(event, '${id}')">
                            <div class="mb-3">
                                <input type="text" class="form-control" id="commentAuthor" placeholder="Ваше ім'я" required>
                            </div>
                            <div class="mb-3">
                                <textarea class="form-control" id="commentContent" rows="3" placeholder="Ваш коментар" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Відправити</button>
                        </form>
                    </div>
                </div>
            `;

            document.getElementById('content').innerHTML = html;
        }

        async function addComment(e, postId) {
            e.preventDefault();
            try {
                await apiCall(`/api/posts/${postId}/comments`, {
                    method: 'POST',
                    body: JSON.stringify({
                        author: document.getElementById('commentAuthor').value,
                        content: document.getElementById('commentContent').value
                    })
                });
                showPost(postId);
            } catch {
                alert('Помилка додавання коментаря');
            }
        }

        async function searchPosts() {
            const query = document.getElementById('searchQuery').value;
            if (!query) return showHome();
            
            const posts = await apiCall(`/api/posts/search/?q=${encodeURIComponent(query)}`);
            displayPosts(posts);
        }

        async function filterByCategory(categoryId) {
            if (!categoryId) return showHome();
            const posts = await apiCall(`/api/posts/category/${categoryId}`);
            displayPosts(posts);
        }

        function displayPosts(posts) {
            let html = '<div class="row">';
            posts.items.forEach(post => {
                html += `
                    <div class="col-md-6 mb-4">
                        <div class="card post-card h-100">
                            <div class="card-body">
                                <h5 class="card-title">${post.title}</h5>
                                <p class="card-text">${post.content.substring(0, 150)}...</p>
                                <button class="btn btn-primary btn-sm" onclick="showPost('${post.id}')">Читати</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            document.getElementById('content').innerHTML = html;
        }

        async function showCategories() {
            const categories = await apiCall('/api/categories');
            
            let html = `
                <h2>Категорії</h2>
                <div class="row">
            `;

            categories.forEach(cat => {
                html += `
                    <div class="col-md-4 mb-3">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">${cat.name}</h5>
                                <p class="card-text">${cat.description}</p>
                                <button class="btn btn-primary btn-sm" onclick="filterByCategory('${cat.id}')">Переглянути пости</button>
                            </div>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            document.getElementById('content').innerHTML = html;
        }

        async function showStats() {
            const topAuthors = await apiCall('/api/stats/top-authors');
            const popularCategories = await apiCall('/api/stats/popular-categories');
            const commentsStats = await apiCall('/api/stats/comments-stats');
            const tagsDistribution = await apiCall('/api/stats/tags-distribution');

            let html = `
                <h2 class="mb-4"><i class="bi bi-bar-chart-fill"></i> Статистика блогу</h2>
                
                <!-- Загальна статистика -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card text-center bg-primary text-white">
                            <div class="card-body">
                                <h2>${commentsStats.total_posts || 0}</h2>
                                <p class="mb-0">Всього постів</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center bg-success text-white">
                            <div class="card-body">
                                <h2>${commentsStats.total_comments || 0}</h2>
                                <p class="mb-0">Всього коментарів</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center bg-info text-white">
                            <div class="card-body">
                                <h2>${commentsStats.average_comments_per_post?.toFixed(1) || 0}</h2>
                                <p class="mb-0">Середньо коментарів</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center bg-warning text-white">
                            <div class="card-body">
                                <h2>${topAuthors.length || 0}</h2>
                                <p class="mb-0">Активних авторів</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <!-- Топ авторів -->
                    <div class="col-md-6 mb-4">
                        <div class="card h-100">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0"><i class="bi bi-people-fill"></i> Топ авторів</h5>
                            </div>
                            <div class="card-body">
                                ${topAuthors.length > 0 ? `
                                    <div class="list-group list-group-flush">
                                        ${topAuthors.map((author, index) => `
                                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                                <div>
                                                    <span class="badge bg-primary rounded-circle me-2">${index + 1}</span>
                                                    <strong>${author.author}</strong>
                                                </div>
                                                <span class="badge bg-success">${author.post_count} ${author.post_count === 1 ? 'пост' : 'постів'}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : '<p class="text-muted">Немає даних</p>'}
                            </div>
                        </div>
                    </div>

                    <!-- Популярні категорії -->
                    <div class="col-md-6 mb-4">
                        <div class="card h-100">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0"><i class="bi bi-folder-fill"></i> Популярні категорії</h5>
                            </div>
                            <div class="card-body">
                                ${popularCategories.length > 0 ? `
                                    <div class="list-group list-group-flush">
                                        ${popularCategories.map(cat => `
                                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                                <strong>${cat.category}</strong>
                                                <span class="badge bg-primary">${cat.post_count} ${cat.post_count === 1 ? 'пост' : 'постів'}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : '<p class="text-muted">Немає категорій з постами</p>'}
                            </div>
                        </div>
                    </div>

                    <!-- Розподіл тегів -->
                    <div class="col-md-6 mb-4">
                        <div class="card h-100">
                            <div class="card-header bg-info text-white">
                                <h5 class="mb-0"><i class="bi bi-tags-fill"></i> Популярні теги</h5>
                            </div>
                            <div class="card-body">
                                ${tagsDistribution.length > 0 ? `
                                    <div class="list-group list-group-flush">
                                        ${tagsDistribution.slice(0, 10).map(tag => {
                                            const percentage = (tag.count / commentsStats.total_posts * 100).toFixed(0);
                                            return `
                                                <div class="list-group-item">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span class="badge bg-secondary">${tag.tag}</span>
                                                        <small class="text-muted">${tag.count} ${tag.count === 1 ? 'раз' : 'рази'}</small>
                                                    </div>
                                                    <div class="progress" style="height: 8px;">
                                                        <div class="progress-bar bg-info" style="width: ${percentage}%"></div>
                                                    </div>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                ` : '<p class="text-muted">Немає тегів</p>'}
                            </div>
                        </div>
                    </div>

                    <!-- Пости з найбільшою кількістю коментарів -->
                    <div class="col-md-6 mb-4">
                        <div class="card h-100">
                            <div class="card-header bg-warning text-dark">
                                <h5 class="mb-0"><i class="bi bi-chat-dots-fill"></i> Найкоментованіші пости</h5>
                            </div>
                            <div class="card-body">
                                ${commentsStats.posts_with_most_comments && commentsStats.posts_with_most_comments.length > 0 ? `
                                    <div class="list-group list-group-flush">
                                        ${commentsStats.posts_with_most_comments.slice(0, 5).map(post => `
                                            <div class="list-group-item">
                                                <div class="d-flex justify-content-between align-items-start">
                                                    <div class="flex-grow-1">
                                                        <h6 class="mb-1">${post.title}</h6>
                                                        <small class="text-muted">by ${post.author}</small>
                                                    </div>
                                                    <span class="badge bg-primary rounded-pill">${post.comment_count} <i class="bi bi-chat"></i></span>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : '<p class="text-muted">Немає коментованих постів</p>'}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('content').innerHTML = html;
        }

        async function showAdminPanel() {
            if (!state.user) {
                alert('Потрібно увійти');
                return;
            }

            const myPosts = await apiCall('/api/posts');
            const categories = await apiCall('/api/categories');

            document.getElementById('content').innerHTML = `
                <h2>Адміністрування</h2>
                
                <div class="admin-section">
                    <h4>Створити новий пост</h4>
                    <form onsubmit="createPost(event)">
                        <div class="mb-3">
                            <label class="form-label">Заголовок</label>
                            <input type="text" class="form-control" id="postTitle" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Контент</label>
                            <textarea class="form-control" id="postContent" rows="5" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Категорія</label>
                            <select class="form-select" id="postCategory">
                                <option value="">Без категорії</option>
                                ${categories.map(c => `<option value="${c.id}">${c.name}</option>`).join('')}
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Теги (через кому)</label>
                            <input type="text" class="form-control" id="postTags" placeholder="tech, programming, news">
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="postPublished">
                            <label class="form-check-label" for="postPublished">Опублікувати</label>
                        </div>
                        <button type="submit" class="btn btn-success">Створити пост</button>
                    </form>
                </div>

                <div class="admin-section">
                    <h4>Створити категорію</h4>
                    <form onsubmit="createCategory(event)">
                        <div class="mb-3">
                            <label class="form-label">Назва</label>
                            <input type="text" class="form-control" id="categoryName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Опис</label>
                            <textarea class="form-control" id="categoryDesc" rows="2" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-success">Створити категорію</button>
                    </form>
                </div>

                <div class="admin-section">
                    <h4>Мої пости</h4>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Заголовок</th>
                                    <th>Категорія</th>
                                    <th>Статус</th>
                                    <th>Дата</th>
                                    <th>Дії</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${myPosts.items.map(p => `
                                    <tr>
                                        <td>${p.title}</td>
                                        <td>${p.category_name || '-'}</td>
                                        <td>${p.published ? '<span class="badge bg-success">Опубліковано</span>' : '<span class="badge bg-warning">Чернетка</span>'}</td>
                                        <td>${new Date(p.created_at).toLocaleDateString('uk-UA')}</td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" onclick="editPost('${p.id}')"><i class="bi bi-pencil"></i></button>
                                            <button class="btn btn-sm btn-danger" onclick="deletePost('${p.id}')"><i class="bi bi-trash"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        async function createPost(e) {
            e.preventDefault();
            try {
                const tags = document.getElementById('postTags').value.split(',').map(t => t.trim()).filter(t => t);
                const categoryValue = document.getElementById('postCategory').value;
                
                const postData = {
                    title: document.getElementById('postTitle').value,
                    content: document.getElementById('postContent').value,
                    tags: tags,
                    published: document.getElementById('postPublished').checked
                };
                
                // Додаємо category_id тільки якщо вибрано категорію
                if (categoryValue) {
                    postData.category_id = categoryValue;
                }
                
                await apiCall('/api/posts', {
                    method: 'POST',
                    body: JSON.stringify(postData)
                });
                
                alert('Пост створено успішно!');
                showAdminPanel();
            } catch (error) {
                console.error('Error creating post:', error);
                alert('Помилка створення поста: ' + (error.message || 'Невідома помилка'));
            }
        }

        async function createCategory(e) {
            e.preventDefault();
            try {
                await apiCall('/api/categories', {
                    method: 'POST',
                    body: JSON.stringify({
                        name: document.getElementById('categoryName').value,
                        description: document.getElementById('categoryDesc').value
                    })
                });
                alert('Категорію створено!');
                showAdminPanel();
            } catch {
                alert('Помилка створення категорії');
            }
        }

        async function deletePost(id) {
            if (!confirm('Видалити пост?')) return;
            try {
                await apiCall(`/api/posts/${id}`, { method: 'DELETE' });
                alert('Пост видалено!');
                showAdminPanel();
            } catch {
                alert('Помилка видалення');
            }
        }

        async function editPost(id) {
            const post = await apiCall(`/api/posts/${id}`);
            const categories = await apiCall('/api/categories');

            document.getElementById('content').innerHTML = `
                <h2>Редагувати пост</h2>
                <form onsubmit="updatePost(event, '${id}')">
                    <div class="mb-3">
                        <label class="form-label">Заголовок</label>
                        <input type="text" class="form-control" id="editTitle" value="${post.title}" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Контент</label>
                        <textarea class="form-control" id="editContent" rows="10" required>${post.content}</textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Категорія</label>
                        <select class="form-select" id="editCategory">
                            <option value="">Без категорії</option>
                            ${categories.map(c => `<option value="${c.id}" ${c.name === post.category_name ? 'selected' : ''}>${c.name}</option>`).join('')}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Теги (через кому)</label>
                        <input type="text" class="form-control" id="editTags" value="${post.tags.join(', ')}">
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="editPublished" ${post.published ? 'checked' : ''}>
                        <label class="form-check-label">Опублікувати</label>
                    </div>
                    <button type="submit" class="btn btn-primary">Зберегти</button>
                    <button type="button" class="btn btn-secondary" onclick="showAdminPanel()">Скасувати</button>
                </form>
            `;
        }

        async function updatePost(e, id) {
            e.preventDefault();
            try {
                const tags = document.getElementById('editTags').value.split(',').map(t => t.trim()).filter(t => t);
                await apiCall(`/api/posts/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify({
                        title: document.getElementById('editTitle').value,
                        content: document.getElementById('editContent').value,
                        category_id: document.getElementById('editCategory').value || null,
                        tags: tags,
                        published: document.getElementById('editPublished').checked
                    })
                });
                alert('Пост оновлено!');
                showAdminPanel();
            } catch {
                alert('Помилка оновлення');
            }
        }

        init();
    </script>
    </body>
</html>